%BEGIN COPYPASTE EL INFORME DEL INFO
\documentclass[10pt, a4paper,english,spanish]{article}
\usepackage{subfig}

\parindent=20pt
\parskip=8pt
\usepackage[width=15.5cm, left=3cm, top=2.5cm, height= 24.5cm]{geometry}

% \usepackage{ccfonts,eulervm} 
% \usepackage[T1]{fontenc}

\usepackage{longtable}
\usepackage{ccfonts,eulervm} 
\usepackage[T1]{fontenc}
% \usepackage{ccfonts,eulervm} 
% \usepackage[T1]{fontenc}
\usepackage{longtable}
\usepackage{epigraph}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage[activeacute, spanish,english]{babel}
\usepackage{cancel}
\usepackage[utf8]{inputenc}
\usepackage{algorithm}
%\usepackage{algpseudocode}
\usepackage{afterpage}
\usepackage{caratula}
\usepackage{url}
\usepackage{fancyhdr}
\usepackage{listings}
\usepackage{ulem}
\usepackage{dashrule}
\usepackage{pdflscape}
\usepackage{pgf}
\usepackage{tikz}
\usetikzlibrary{arrows,automata}


\floatname{algorithm}{Algoritmo}

\newtheorem{theorem}{Teorema}[section]
\newtheorem{lemma}[theorem]{Lema}
\newtheorem{proposition}[theorem]{Proposici\'on}
\newtheorem{corollary}[theorem]{Corolario}

\newcommand{\Var}{\textbf{var }}
\newcommand{\True}{\textbf{true }}
\newcommand{\False}{\textbf{false }}
\newcommand{\Break}{\textbf{break }}
\newcommand{\Continue}{\textbf{continue }}
\newcommand{\Param}{\textbf{param }}
\newcommand{\ig}[3]{
	\begin{landscape}
		\begin{figure}[c]
			\label{diag_diseno}
			\includegraphics[scale=#2]{images/#1.pdf}
			\caption{#3}
		\end{figure} 
	\end{landscape}
	\newpage
}




% \parindent 0em
%\algrenewcommand{\algorithmiccomment}[1]{//\textit{#1} }

\renewcommand{\emph}[1]{\textit{#1}}
\pagestyle{fancy}
\thispagestyle{fancy}
\addtolength{\headheight}{1pt}
\lhead{Seguridad - TP1}
\rhead{Grupo 8}
\cfoot{\thepage}
\renewcommand{\footrulewidth}{0.4pt}
\newcommand{\hblacksquare}{\hfill \blacksquare}
%FIN COPYPASTE EL INFORME DEL INFO
\begin{document}

\materia{Seguridad de la Información}
\submateria{Segundo Cuatrim\'estre de 2013}
\titulo{Trabajo Pr\'actico: Malito}
\subtitulo{La Llama que \textbf{no} llama}
\grupo{Grupo ``Queremos sanguiches de miga''}
\integrante{Juli\'an Sackmann}{540/09}{jsackmann@gmail.com}
\integrante{Juan Pablo Darago}{272/10}{jpdarago@gmail.com}
\integrante{Vanesa Stricker}{159/09}{vanesastricker@gmail.com}
% \integrante{Mat\'ias Barbeito}{179/08}{matiasbarbeito@gmail.com}

\maketitle
\pagebreak

\tableofcontents
\pagebreak

\section{Introducción} % (fold)
\label{sec:introducci_n}

La primer parte del TP requiere implementar un \emph{malware} para \texttt{Android} que, al instalarse, envíe las fotos del teléfono a las que tenga acceso a un servidor controlado por nosotros. Para esto, es necesario tomar una serie de decisiones, que se detallan a continuación:

\subsection{Façade} % (fold)
\label{sub:fa_ade}
Si bien no tenemos datos certeros de esto, creemos que es extremadamente poco probable que el usario promedio de \texttt{Android} instale voluntariamente una aplicación que se publicite a si mismo como ``TeRoboLasFotosApp''. Es por esto que consideramos necesario \textbf{disfrazar} el app, de tal forma que la probabilidad de una instalación se incremente ligeramente. 

Aprovechando esta necesidad de disfrazar el app, nos propusimos cumplir uno de nuestros sueños y realizar la facade de este app siguiendo el diseño general de un \textbf{soundboard} de la llama que llama. Este tipo de aplicaciones tienen como objetivo el de presentar al usuario con una serie de botones, cada uno de los cuales emite un sonido al ser presionado. En general, estas aplicaciones ofrecen la funcionalidad de setear estos sonidos como ringtones de mensajes o llamadas.

En nuestro caso decidimos instanciar el modelo de soundboard en el viejo y querido La llama Que Llama. 

%Alguien complete este chamuyo porque me aburri.

QUIERO UN ARCOIRIS MONOCROMO
\subsection{Information Upload} % (fold)
\label{sub:Information Upload}
Otra decisión que se tuvo que tomar a la hora de implementar el robo de imágenes era la concerniente a la forma de transmisión de esas imágenes al servidor controlado por nosotros. 

Consideramos las siguientes opciones:
\begin{itemize}
	\item Email
	\item POST
	\item scp
\end{itemize}


Prinicpalmente por facilidad en su implementación, así como compatibilidad con la mayor parte de celular posibles\footnote{scp sería mucho más fácil de implementar, pero sólo funcionaría con teléfonos \texttt{Android} que tengan \texttt{BusyBox} instalado, lo que limita mucho el alcance posible del ataque.}, elegimos el método POST.

Para la implementación de este método se utilizó una libería de multipart post (JUAMPI COMPLETA ESTO MEJOR PORQUE NO TENOG NI DIEA QUE PONER ESTOY RE DURO COMO ALIAGAGA Y LOS CUARENTA LADRONES).


\subsection{Servidor} % (fold)
\label{sub:Servidor}
Del lado del servidor se implementó un script de PHP que se ocupa de recibir los POST, validarlos y almacenar la imagen.

\subsubsection{Validación} % (fold)
En primer lugar, dado que el servicio de PHP está ubicado en un servidor de acceso público es imprescindible realizar algún tipo de validación de que las solicitudes de POST que llegan sean efectivamente enviadas por la aplicación y no por un tercero. Es por esto que se incluyó en el código de la aplicación una clave secreta con la que se hashea el la imagen. Este hash es replicado oportunamente por el servidor y, en caso de no coincidir, el POST es descartado.
\label{subsub:Validación}

% subsubsection Validación (end} 

\subsubsection{Envío Diferencial} % (fold)
\label{ssub:Envío Diferencial}
Uno de los principales problemas que tuvimos al testear la aplicación era que, en un principio, se subían todas las fotos todo el tiempo. Si bien esto no es un problema del lado del servidor (simplemente se pisaban los archivos, no se generaban duplicados), genera mucho tráfico de red inútilmente. Es por esto que decidimos utilizar un sistema de envío diferencial de imágenes. 

Consideramos dos métodos para realizar esto:
\begin{itemize}
	\item Que la aplicación almacene en el mismo teléfono la lista de las imágenes ya subidas (por ejemplo, aprovechando los servicios de SQLite).
	\item Que la aplicación consulte con el servidor qué imágenes debe mandar. 
\end{itemize}
% subsubsection Envío Diferencial (end)

Tanto por simplicidad de implementación como para evitar dejar rastros en el teléfono, decidimos implementar la segunda. Además, tiene la ventaja de que si el usuario desistanala la aplicación (o elimina sus datos locales desde el menú de Androdid) no vuelven a enviarse todas las fotos. 

Como desventaja de esto, se puede mencionar que el teléfono debe realizar más transimisones por la red (aunque muy pequeñas), que podrían ser detectadas por un sniffer.


La implementación actual de esta característica está hecha de la siguiente manera: para cada foto a la que tiene acceso, la aplicación envía un POST al servidor con el hash \textbf{SHA1} de la imagen en cuestión. Cuando el servidor lo recibe, verifica si alguna de las imágenes que tiene guardadad tiene ese mismo \textbf{SHA1}. En el caso de no encontrarla, el servidor responde al POST con el mensaje 'OK', tras lo cual la aplicación envía la imágen mediante otro POST.
En caso contrario, la respuesta es 'FOUND' (y, obviamente, la aplicación no envía la imagen).

% subsection  (end)

% subsection Servidor (end)
% subsection Information Upload (end)
% subsection fa_ade (end)

\subsubsection{Mejoras} % (fold)
\label{ssub:Mejoras}
\begin{itemize}
	\item Hacer un solo request para las fotos en vez de muchos.
	\item Almacenamiento ordenado por IMEI.
	\item Encriptar las fotos que van por la red (no queremos darle 100 años de perdón a nadie).
	\item Poder setear sonido como ringtone.
\end{itemize}

% subsubsection Mejoras (end)
% section introducci_n (end)


\addcontentsline{toc}{section}{Referencias}
\begin{thebibliography}{8}
\raggedright

\bibitem{AndroidMalware}
	El librito ese.
	\newblock {Re loco}.
	\newblock De colores.

\end{thebibliography}

\end{document}
